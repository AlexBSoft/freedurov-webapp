<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport"
        content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no" />
    <meta name="format-detection" content="telephone=no" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="MobileOptimized" content="176" />
    <meta name="HandheldFriendly" content="True" />
    <meta name="robots" content="noindex,nofollow" />
    <script src="https://telegram.org/js/telegram-web-app.js?2"></script>
    <script>
       Telegram.WebApp.setHeaderColor("#424242");
    </script>
    <title></title>
    <link rel="stylesheet" href="style.css">
    <style>
        .counter-button {
            border-radius: 50%;
            width: 100px;
            height: 100px;
            font-size: 16px;
            margin: 0 auto;
            background-color: #000;
        }

        body {
            background-color: #424242;
            color: #fff;
        }
    </style>
</head>

<body >

    <div style="position: absolute; top: 0; left: 0; width: 100%; z-index: -1; overflow: hidden;">
        <img src="durov.jpeg" alt="Durov" style="width: 100%; height: auto; filter: brightness(1);">
        <div
            style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; background: linear-gradient(to bottom, rgba(66, 66, 66, 0) 0%, rgba(66, 66, 66, 1) 100%);">
        </div>
    </div>
    <div class="counter-container"
        style="text-align: center; display: flex; flex-direction: column; align-items: center; height: calc(100vh - 92px); justify-content: flex-end; position: absolute; bottom: 64px; width: 100%;">
        <span id="counterValue" style="font-size: 48px; display: block; margin-bottom: 10px;">0</span>
        <div style="position: relative; width: 100px; margin: 0 auto;">
            <div id="energyBar"
                style="width: 100%; height: 10px; background-color: #ccc; border-radius: 5px; position: relative; margin-bottom: 10px;">
            </div>
            <button id="counterButton"
                style="border-radius: 50%; width: 100px; height: 100px; font-size: 16px; margin: 0 auto; position: relative; z-index: 1; overflow: hidden; transition: transform 0.1s;"
                class="counter-button">Tap</button>

            <script>
                const button = document.getElementById('counterButton');
                button.addEventListener('click', function (e) {

                    // Прожимание кнопки
                    button.style.transform = 'scale(0.95)';
                    setTimeout(() => {
                        button.style.transform = 'scale(1)';
                    }, 100);
                });
            </script>
        </div>
    </div>

    <div
        style="position: fixed; bottom: 0; left: 0; right: 0; height: 16px; overflow: hidden; background-color: #424242;">
        <div style="white-space: nowrap; animation: marquee 10s linear infinite;">
            <span style="color: #ffffff31;" id="freeDurovText">#FreeDurov</span>
        </div>
    </div>

    <style>
        @keyframes marquee {
            0% {
                transform: translateX(100%);
            }

            100% {
                transform: translateX(-100%);
            }
        }
    </style>


    <!-- <nav style="position: fixed; bottom: 0; left: 0; right: 0; background-color: #424242; display: flex; justify-content: space-around; padding: 10px 0;">
    <a href="#" style="color: #fff; text-align: center; text-decoration: none;">
        <div>Tab 1</div>
    </a>
    <a href="#" style="color: #fff; text-align: center; text-decoration: none;">
        <div>Tab 2</div>
    </a>
    <a href="#" style="color: #fff; text-align: center; text-decoration: none;">
        <div>Tab 3</div>
    </a>
</nav> -->

    <script>
        javascript:(function () { var script = document.createElement('script'); script.src="https://cdn.jsdelivr.net/npm/eruda"; document.body.append(script); script.onload = function () { eruda.init(); } })();

        const DemoApp = {
            initData: Telegram.WebApp.initData || '',
            initDataUnsafe: Telegram.WebApp.initDataUnsafe || {},
            MainButton: Telegram.WebApp.MainButton,
            BackButton: Telegram.WebApp.BackButton,
            SettingsButton: Telegram.WebApp.SettingsButton,
            init(options) {
                document.body.style.visibility = ''
                Telegram.WebApp.ready()
                Telegram.WebApp.MainButton.setParams({
                    text: 'CLOSE WEBVIEW',
                    is_visible: true
                }).onClick(DemoApp.close)
                Telegram.WebApp.BackButton.onClick(function () {
                    DemoApp.showAlert('Back button pressed')
                })
                Telegram.WebApp.SettingsButton.onClick(function () {
                    DemoApp.showAlert('Settings opened!')
                })
            },
            expand() {
                Telegram.WebApp.expand();
            },
            close() {
                Telegram.WebApp.close();
            },
        }

        let count = 0;
        let energy = 100; // начальное количество энергии
        const energyBar = document.getElementById('energyBar');

        const counterValue = document.getElementById('counterValue');

        function updateEnergyBar() {
            energyBar.style.width = (energy * 1) + 'px'; // 100 энергии = 100px
        }

        function restoreEnergy() {
            if (energy < 100) {
                energy++;
                updateEnergyBar();
            }
        }

        button.addEventListener('click', () => {
            if (energy > 0) {
                count++;
                counterValue.textContent = count;
                energy--;
                updateEnergyBar();
                Telegram.WebApp.CloudStorage.setItem("count", count)
            }
            Telegram.WebApp.HapticFeedback.impactOccurred('light');
        });


        Telegram.WebApp.CloudStorage.getItem("count", function (err, value) {
            if (err) {
                DemoApp.showAlert('Error: ' + err);
            } else {
                count=value
            }
        })

        setInterval(restoreEnergy, 3000); // восстанавливать 1 энергию каждые 3 секунды
        updateEnergyBar(); // инициализация полосы энергии

        DemoApp.checkInitData();
    DemoApp.init();
    </script>

</body>

</html>